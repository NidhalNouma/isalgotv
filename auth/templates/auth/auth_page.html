<!-- templates/_base.html -->

{% load compress %} {% load static %}
{% load custom_tags %}

<!DOCTYPE html>
<html lang="en" class="max-w-screen overflow-x-hidden">
  <head>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@200..800&family=Azeret+Mono:ital,wght@0,100..900;1,100..900&family=Commissioner:wght@100..900&display=swap" rel="stylesheet" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    {% block head_title %}
      <title>IsAlgo | Login</title>
    {% endblock %}
    {% block head_description %}
      <meta name="description" content="Unlock powerful TradingView strategies to enhance your trading performance. Whether you're a beginner or a pro, discover backtestable, automatable systems crafted to work across any market and timeframe. Start optimizing your trades today with IsAlgo." />
    {% endblock %}

    <!-- This is for search engines and won't affect the actual URL directly, but it's a good practice to ensure your slug is reflected in the URL structure managed by your server or CMS -->
    <link rel="canonical" href="https:www.//isalgo.com/easy-trading-strategies-for-all-levels" />
    <link rel="icon" href="{% static 'images/logo.png' %}" type="image/x-icon" />
    <link rel="icon" sizes="16x16" href="{% static 'images/logo_img_16_16.png' %}" />
    <link rel="icon" sizes="32x32" href="{% static 'images/logo_img_32_32.png' %}" />
    <link rel="icon" sizes="48x48" href="{% static 'images/logo_img_48_48.png' %}" />
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'images/logo_img_180_180.png' %}" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="{% static 'images/seo-meta-img.png' %}" />

    <!-- Open Graph / Facebook meta tags -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="IsAlgo" />
    <meta property="og:description" content="Dive into trading strategies that work across any market and timeframe. Perfect for both beginners and advanced traders, our guide offers backtestable and automatable solutions to elevate your trading game." />
    <meta property="og:url" content="https://www.isalgo.com" />
    <meta name="og:image" content="{% static 'images/seo-meta-img.png' %}" />

    <!-- Twitter Card meta tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="IsAlgo" />
    <meta name="twitter:description" content="Dive into trading strategies that work across any market and timeframe. Perfect for both beginners and advanced traders, our guide offers backtestable and automatable solutions to elevate your trading game." />
    <meta name="twitter:url" content="https://www.isalgo.com" />
    <meta name="twitter:image" content="{% static 'images/seo-meta-img.png' %}" />

    {% block head %}

    {% endblock %}

    {% compress css %}
    <link rel="stylesheet" href="{% static 'src/output.css' %}" />
    {% endcompress %}

    <script src="https://js.stripe.com/v3/"></script>
    <script type="text/javascript">
      const stripe_public_key = '{{ stripe_public_key }}'
      
      // Load theme
      if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark')
      } else {
        document.documentElement.classList.remove('dark')
      }
    </script>
    <script src="{% static 'js/htmx.min.js' %}" defer></script>
    <script src="{% static 'js/index.js' %}" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.js"></script>

    <!-- Google Tag Manager -->
    <script>
      ;(function (w, d, s, l, i) {
        w[l] = w[l] || []
        w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' })
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != 'dataLayer' ? '&l=' + l : ''
        j.async = true
        j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl
        f.parentNode.insertBefore(j, f)
      })(window, document, 'script', 'dataLayer', 'GTM-WZRB9CDM')
    </script>
    <!-- End Google Tag Manager -->
  </head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7B05SE08Q7"></script>
  <script>
    window.dataLayer = window.dataLayer || []
    function gtag() {
      dataLayer.push(arguments)
    }
    gtag('js', new Date())
    
    gtag('config', 'G-7B05SE08Q7')
  </script>
  <!-- end Google tag -->

  <body class="bg-background flex flex-col min-h-screen relative max-w-full mx-auto overflow-x-clip">
    <!-- Google Tag Manager (noscript) -->
    <noscript>
      <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WZRB9CDM" height="0" width="0" style="display: none; visibility: hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    {% block toppage %}

    {% endblock %}
    {% comment %} {% include 'sidenav.html' %} {% endcomment %}
    <main id="main-div" class="w-full px-4 mx-auto grow flex flex-col relative">
      <nav id="nav-bar" class="sticky w-full rounded-b mt-0 mx-auto z-40 top-0 px-2 pt-3 pb-2">
        <div class="absolute top-0 bottom-0 w-full scale-x-150 nav-bg -z-10"></div>
        <div class="relative flex flex-wrap items-center justify-between mx-auto py-1.5 sm:py-2">
          <div class="flex">
            <a href="/" class="flex items-center">
              <div class="flex justify-center items-end">
                <svg class="sm:h-9 h-8 aspect-square fill-title stroke-title" viewBox="0 0 215 345" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M149.883 5L149.883 82.8993" stroke-width="10" stroke-linecap="round"/>
                  <path d="M151.954 56.6274H147.068C146.169 56.6274 145.44 59.3617 145.44 62.7345V111.591C145.44 114.964 146.169 117.698 147.068 117.698H151.954C152.854 117.698 153.583 114.964 153.583 111.591V62.7345C153.583 59.3617 152.854 56.6274 151.954 56.6274Z"  stroke-width="15"/>
                  <path d="M66.1495 293.913L61.4934 293.843C60.6363 293.83 59.959 291.038 59.9808 287.607L60.2959 237.909C60.3177 234.478 61.0302 231.707 61.8874 231.72L66.5434 231.79C67.4006 231.803 68.0778 234.595 68.0561 238.026L67.7409 287.724C67.7192 291.155 67.0067 293.926 66.1495 293.913Z" stroke-width="15"/>
                  <path d="M64.0391 282.667L64.0391 339.972"  stroke-width="10" stroke-linecap="round"/>
                  <path d="M13.415 103.37C5.69091 111.561 1.26247 121.257 0.241659 132.642C-1.11412 147.763 3.23012 160.772 13.3935 171.853C20.5487 179.655 29.6828 183.905 39.2653 187.426C56.4993 193.758 73.7318 200.094 90.9886 206.36C92.6111 206.949 93.2601 207.7 93.1647 209.527C93.0353 212.003 93.3534 214.5 93.3561 216.988C93.3824 241.719 93.3506 266.451 93.4274 291.182C93.4386 294.782 93.4184 298.133 90.2377 300.607C89.2917 301.343 88.7526 302.681 88.1486 303.811C83.9733 311.623 84.17 319.51 88.6813 326.958C93.1164 334.281 100.006 337.809 108.385 337.325C117.421 336.803 123.886 331.834 127.211 323.323C130.647 314.525 129.086 306.247 122.867 299.155C121.173 297.223 120.414 295.353 120.419 292.763C120.483 258.989 120.411 225.214 120.52 191.439C120.53 188.303 119.497 186.972 116.674 185.931C93.6743 177.452 70.7357 168.801 47.7764 160.209C44.5471 159 41.3781 157.679 38.598 155.547C24.2109 144.516 27.8751 126.186 39.717 119.48C49.2641 114.073 58.4774 108.053 67.8827 102.38C69.4083 101.46 69.9566 100.353 69.944 98.5829C69.8805 89.6321 69.9298 80.6805 69.913 71.7293C69.9058 67.8776 69.3039 67.4559 66.085 69.3962C55.1244 76.0029 44.1994 82.6717 33.2871 89.3615C26.484 93.5321 19.3912 97.2825 13.415 103.37ZM206.44 183.096C205.041 181.174 203.739 179.192 202.179 177.38C194.871 168.892 185.188 164.435 175.114 160.71C158.237 154.47 141.327 148.321 124.384 142.271C121.507 141.244 120.353 139.877 120.379 136.559C120.552 114.694 120.476 92.8269 120.477 70.9603C120.477 68.2854 120.541 65.6054 120.402 62.9372C120.298 60.9632 119.402 60.0415 117.352 61.1279C110.533 64.7396 103.717 64.7189 96.87 61.1089C94.1433 59.6713 93.1535 60.3553 93.0685 63.599C93.0033 66.0837 93.0673 68.572 93.0777 71.0587C93.1982 100.026 93.3526 128.992 93.3836 157.959C93.3863 160.532 94.2463 161.676 96.558 162.531C120.221 171.284 143.734 180.46 167.53 188.841C170.439 189.866 173.318 191.033 175.792 192.92C182.129 197.755 185.319 204.062 184.113 212.317C183.158 218.855 179.352 223.364 174.084 226.688C164.718 232.599 155.295 238.416 145.828 244.156C143.957 245.29 143.211 246.616 143.232 248.812C143.318 257.76 143.257 266.71 143.285 275.66C143.288 276.714 142.882 278.072 144.095 278.652C145.216 279.187 146.121 278.19 147.037 277.647C161.085 269.312 175.078 260.88 189.186 252.651C213.755 238.32 221.472 207.918 206.44 183.096Z" />
                  <ellipse cx="107.059" cy="36.1608" rx="15.2944" ry="17.3112" />
                </svg>
              </div>
            </a>
          </div>

          <a class="btn-icon" href="/" id="auth-exit-btn">
            <svg class="w-6 aspect-auto" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
          </a>
        </div>
      </nav>

      <div class="min-h-[80vh] flex flex-col relative px-2" id="page-main-div">
        {% block page %}

        {% endblock %}
      </div>

      <script>
        ;(function () {
          const key = 'auth_origin'
          // Extract the parent domain (e.g. "isalgo.com" from "www.isalgo.com")
          function getParentDomain(hostname) {
            var parts = hostname.split('.')
            return parts.length >= 2 ? parts.slice(-2).join('.') : hostname
          }
          var currentParent = getParentDomain(window.location.hostname)
        
          // On first auth page load, store the referrer if it's from our site
          if (!sessionStorage.getItem(key)) {
            var referrer = document.referrer
            if (referrer) {
              try {
                var url = new URL(referrer)
                var refParent = getParentDomain(url.hostname)
                if (refParent === currentParent) {
                  // Same subdomain: store relative path; different subdomain: store full URL
                  if (url.origin === window.location.origin) {
                    sessionStorage.setItem(key, url.pathname + url.search)
                  } else {
                    sessionStorage.setItem(key, url.href)
                  }
                }
              } catch (e) {}
            }
          }
        
          var origin = sessionStorage.getItem(key) || '/'
          document.getElementById('auth-exit-btn').href = origin
        
          // Populate hidden next input in login/register forms
          var nextInput = document.getElementById('auth-next-input')
          if (nextInput && origin !== '/') {
            nextInput.value = origin
          }
        
          // Append next param to Google OAuth link
          if (origin !== '/') {
            document.querySelectorAll('.auth-google-btn').forEach(function (btn) {
              var href = btn.getAttribute('href')
              var sep = href.includes('?') ? '&' : '?'
              btn.setAttribute('href', href + sep + 'next=' + encodeURIComponent(origin))
            })
          }
        })()
      </script>
    </main>
  </body>
</html>
