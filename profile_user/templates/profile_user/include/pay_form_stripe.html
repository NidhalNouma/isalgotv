{% if not has_subscription %}
  <div class="mb-4">
    <h6 class="text-text/80 text-sm font-medium">
      {% if strategy_price %}
        You’re a few clicks away from gaining access to this exclusive trading strategy.
      {% else %}
        You’re a few click away from gaining access to our expert trading strategies, premium access, and much more.
      {% endif %}
    </h6>
    {% if free_trial_days and free_trial_days|add:'0' > 0 and title != "LIFETIME" and not user_profile.subscription_id %}
      <h6 class="mt-1.5 text-title bg-title/20 rounded-lg px-2 py-1 inline-block text-xs font-medium">First {{ free_trial_days }} days free</h6>
    {% endif %}
  </div>
{% endif %}

<form hx-post="{% url 'membership-coupon' %}?plan={{ title }}" class="relative" id="coupon-pay-{{ title }}-form">
    {% csrf_token %}
    {% include 'include/pay_form_coupon.html' with current_subscription=current_subscription %}
    <div id="have-coupon-{{title}}" class=" w-full flex mb-4"><button type="button" onclick="changeHidden('coupon-input-{{title}}', 'have-coupon-{{title}}')" class="btn-icon ml-auto px-0">Have a coupon?</button></div>
</form>

<form
  {% if strategy_price %}
    hx-post="{% url 'strategy_subscribe' strategy_price.id %}?title={{ title }}"
  {% else %}
    {% if user_profile.subscription_id and subscription.status != 'canceled' %}
      hx-post="{% url 'membership-update' %}?plan={{ title }}&get_started={{ get_started }}"
    {% else %}
      hx-post="{% url 'membership-create' %}?plan={{ title }}&get_started={{ get_started }}"
    {% endif %}
  {% endif %}
  class="relative"
  id="form-pay-{{ title }}"
>
  {% csrf_token %}

  {% include "include/pay_form_stripe_element.html" %}

  <input type="text" name="pm_id" id="pm-{{title}}" class="hidden" value="{{stripe_customer.invoice_settings.default_payment_method}}" />
  <input type="text" name="coupon" id="stripe-pay-coupon-{{title}}" class="hidden" value="" />

  <div class="mb-0 mt-3" id="stripe-next-{{title}}">

    {% include 'include/pay_next.html' with id="info-pay-submit-{{title}}" %}
  </div>

  <div class="mb-3 mt-3" id="stripe-error-{{title}}">
    {% include 'include/errors.html' with error=error id="error-pay-submit-{{title}}" %}
  </div>

  <div class="w-full pt-3">
    <button
      type="button"
      onclick="onPayFormStripeElementSubmit('{{title}}')"
      id="btn-pay-submit-{{title}}"
      class="group btn-accent block w-full max-w-full mx-auto font-semibold text-center"
    >
      <div id="submit-btn-sub-{{title}}" class="flex items-center justify-center w-full">
        Subscribe
        <svg
          class="h-4 w-4 ml-1 group-hover:scale-110 transition-transform"
          stroke="currentColor"
          fill="currentColor"
          stroke-width="0.5"
          version="1.1"
          viewBox="0 0 16 16"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M8 16c4.418 0 8-3.582 8-8s-3.582-8-8-8-8 3.582-8 8 3.582 8 8 8zM8 1.5c3.59 0 6.5 2.91 6.5 6.5s-2.91 6.5-6.5 6.5-6.5-2.91-6.5-6.5 2.91-6.5 6.5-6.5zM8 9.356c1.812 0 3.535-0.481 5-1.327-0.228 2.788-2.393 4.971-5 4.971s-4.772-2.186-5-4.973c1.465 0.845 3.188 1.329 5 1.329zM4 5.5c0-0.828 0.448-1.5 1-1.5s1 0.672 1 1.5c0 0.828-0.448 1.5-1 1.5s-1-0.672-1-1.5zM10 5.5c0-0.828 0.448-1.5 1-1.5s1 0.672 1 1.5c0 0.828-0.448 1.5-1 1.5s-1-0.672-1-1.5z"
          ></path>
        </svg>
      </div>
      {% comment %} <div id="submit-btn-next-{{title}}" class=" items-center justify-center w-full flex">
        Next
        <svg class="h-3 w-4 ml-1" stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="m268 112 144 144-144 144m124-144H100"></path></svg>
      </div> {% endcomment %}
    </button>

    <button
      id="spinner-pay-submit-{{title}}"
      disabled
      type="button"
      class="hidden btn-accent w-full mx-auto"
    >
      Subscribing 
      {% include 'svg/spinner.html' with class='ml-1 h-4' %}
    </button>
  </div>
</form>
